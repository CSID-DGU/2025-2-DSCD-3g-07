# 성능 평가 지표 설명서

## 1. 전체 시간 정확도 (accuracy_percent)

### 비교 대상

| 항목 | DB 컬럼 | 설명 | 값 예시 |
|------|---------|------|--------|
| **예상 시간** | estimated_time_seconds | 앱이 안내한 총 소요 시간 | 1800초 (30분) |
| **실제 시간** | actual_time_seconds | 안내 시작~종료 버튼 사이 실제 시간 | 1980초 (33분) |

### 계산 방식

```
전체 시간 정확도 = 100 - |실제 시간 - 예상 시간| / 예상 시간 × 100
```

**예시**: 예상 1800초, 실제 1980초
```
정확도 = 100 - |1980 - 1800| / 1800 × 100 = 100 - 10 = 90%
```

### 예상 시간 구성

| 경로 모드 | 구성 요소 |
|----------|----------|
| **대중교통** | 보정된 보행시간 + 횡단보도 대기(1/3) + 대중교통 탑승시간 |
| **도보** | 보정된 보행시간 + 횡단보도 대기(1/3) |

### 왜 필요한가?

- **사용자 관점의 서비스 품질 지표**
- 사용자가 "이 앱 믿고 약속 시간 잡아도 되나?"를 판단하는 기준
- 보행, 대중교통, 대기 시간 모두 포함한 **종합 정확도**

### 한계점

- 대중교통 연착/조기 도착은 예측 불가능한 외부 요인
- 전체 정확도가 낮아도 **앱의 보행 예측 자체는 정확할 수 있음**

---

## 2. 보행 시간 정확도 (walk_accuracy_percent)

### 비교 대상

| 항목 | DB 컬럼 | 설명 | 값 예시 |
|------|---------|------|--------|
| **예측 보행 시간** | estimated_walk_time_seconds | 보정된 보행시간 + 횡단보도 대기(1/3) | 600초 (10분) |
| **실제 보행 시간** | active_walking_time_seconds | 앱이 측정한 실제 걸은 시간 (정지 제외) | 552초 (9분 12초) |

### 계산 방식

```
보행 시간 정확도 = 100 - |실제 보행 시간 - 예측 보행 시간| / 예측 보행 시간 × 100
```

**예시**: 예측 600초, 실제 552초
```
정확도 = 100 - |552 - 600| / 600 × 100 = 100 - 8 = 92%
```

### 예측 보행 시간에 적용되는 보정 요소

| 요소 | 설명 | 적용 방식 |
|------|------|----------|
| **개인 속도** | Health Connect 기반 사용자 평균 보행 속도 | 속도 계수 (예: 1.1 = 10% 빠름) |
| **경사도** | Tobler's Hiking Function 기반 | 오르막 감속, 완만한 내리막 가속 |
| **날씨** | 기온, 강수량 기반 | 극한 기온/강수 시 감속 |
| **횡단보도** | 대기 시간 1/3 적용 | 평균 신호 대기 시간 반영 |

### 실제 보행 시간 측정 방식

- **Step Counter** 기반 움직임 감지
- **정지 구간 제외**: 5초 이상 정지한 시간은 보행 시간에서 제외
- **대중교통 탑승 제외**: 버스/지하철 탑승 중인 시간 제외

### 왜 필요한가?

- **순수 보행 예측 알고리즘의 성능 지표**
- 대중교통 지연 등 **외부 요인을 제외**한 평가
- **개선 가능한 영역**만 측정 (속도 계수, 경사도 계수, 날씨 계수)

### 장점

- 버스가 10분 연착해도 보행 정확도에는 영향 없음
- 알고리즘 자체의 성능을 정확히 파악 가능
- 어떤 보정 요소를 개선해야 하는지 방향 제시

---




## 두 지표가 함께 필요한 이유

### 문제 원인 파악

| 상황 | 전체 정확도 | 보행 정확도 | 해석 |
|------|------------|------------|------|
| A | 90% | 92% | ✅ 전체적으로 정확 |
| B | 70% | 91% | 대중교통 지연 발생, 보행 예측은 정상 |
| C | 75% | 72% | ⚠️ 보행 예측 모델 개선 필요 |
| D | 95% | 65% | 보행 오차를 대중교통이 상쇄 (우연) |

### 결론

- **전체 정확도**만 보면 → 문제 원인 파악 불가
- **보행 정확도**와 함께 보면 → 대중교통 문제인지, 보행 예측 문제인지 구분 가능

---

## DB 스키마

### navigation_logs 테이블

```sql
-- 전체 시간 정확도 관련
estimated_time_seconds      INTEGER NOT NULL    -- 예상 시간 (초)
actual_time_seconds         INTEGER NOT NULL    -- 실제 시간 (초)
time_difference_seconds     INTEGER             -- 시간 차이 (실제 - 예상)
accuracy_percent            NUMERIC(5, 2)       -- 전체 정확도 (%)

-- 보행 시간 정확도 관련
estimated_walk_time_seconds INTEGER             -- 예측 보행 시간 (초)
active_walking_time_seconds INTEGER             -- 실제 보행 시간 (초)
walk_time_difference_seconds INTEGER            -- 보행 시간 차이
walk_accuracy_percent       NUMERIC(5, 2)       -- 보행 정확도 (%)
```

---

## 활용 방안

### 1. 개인별 분석
- 특정 사용자의 정확도가 지속적으로 낮으면 → 개인 속도 프로필 재측정 권장

### 2. 경로별 분석
- 특정 경로의 보행 정확도가 낮으면 → 해당 구간 경사도 데이터 검증

### 3. 날씨별 분석
- 우천 시 정확도가 낮으면 → 날씨 계수 재조정 필요

### 4. 시간대별 분석
- 출퇴근 시간 전체 정확도 하락 → 대중교통 혼잡 반영 필요 (향후 개선)
