# ê²½ì‚¬ë„ ë¶„ì„ ê¸°ëŠ¥ ê°œë°œ ìµœì¢… ë³´ê³ ì„œ

**í”„ë¡œì íŠ¸**: PaceTry - ëŒ€ì¤‘êµí†µ ê²½ë¡œ ê²½ì‚¬ë„ ë¶„ì„ ë° ë³´í–‰ ì‹œê°„ ë³´ì •
**ê°œë°œ ê¸°ê°„**: 2025ë…„ 10ì›” 25ì¼
**ì‘ì„±ì**: AI Development Team

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ ê°œìš”](#1-í”„ë¡œì íŠ¸-ê°œìš”)
2. [ê°œë°œ ê³¼ì • íƒ€ì„ë¼ì¸](#2-ê°œë°œ-ê³¼ì •-íƒ€ì„ë¼ì¸)
3. [Phase 1: ì´ˆê¸° êµ¬í˜„](#3-phase-1-ì´ˆê¸°-êµ¬í˜„)
4. [Phase 2: UI í†µí•© ê°œì„ ](#4-phase-2-ui-í†µí•©-ê°œì„ )
5. [Phase 3: ì†ë„ ëª¨ë¸ ê°œì„ ](#5-phase-3-ì†ë„-ëª¨ë¸-ê°œì„ )
6. [Phase 4: ê³„ì‚° ì •í™•ë„ ê°œì„ ](#6-phase-4-ê³„ì‚°-ì •í™•ë„-ê°œì„ )
7. [ë°œê²¬ëœ ë¬¸ì œì ê³¼ í•´ê²°ì±…](#7-ë°œê²¬ëœ-ë¬¸ì œì ê³¼-í•´ê²°ì±…)
8. [ìµœì¢… ê²°ê³¼ë¬¼](#8-ìµœì¢…-ê²°ê³¼ë¬¼)
9. [ì„±ê³¼ ë° êµí›ˆ](#9-ì„±ê³¼-ë°-êµí›ˆ)
10. [Phase 5: UI ê°œì„  ë° ì„¤ì • ì¡°ì •](#10-phase-5-ui-ê°œì„ -ë°-ì„¤ì •-ì¡°ì •-2025-10-26)

---

## 1. í”„ë¡œì íŠ¸ ê°œìš”

### 1.1 ëª©ì 
ëŒ€ì¤‘êµí†µ ê²½ë¡œ ì•ˆë‚´ ì‹œ ë„ë³´ êµ¬ê°„ì˜ ê²½ì‚¬ë„ë¥¼ ê³ ë ¤í•˜ì—¬ ë” ì •í™•í•œ ë³´í–‰ ì‹œê°„ì„ ì˜ˆì¸¡í•˜ê³ , ì‚¬ìš©ìì—ê²Œ ê²½ì‚¬ ì •ë³´ë¥¼ ì œê³µí•˜ì—¬ ë” ë‚˜ì€ ê²½ë¡œ ì„ íƒì„ ì§€ì›

### 1.2 í•µì‹¬ ìš”êµ¬ì‚¬í•­
- Tmap Transit APIì˜ ê²½ë¡œ ë°ì´í„°ì—ì„œ ë³´í–‰ êµ¬ê°„ ì¶”ì¶œ
- Google Elevation APIë¥¼ ì‚¬ìš©í•œ ê³ ë„ ë°ì´í„° ìˆ˜ì§‘
- ê²½ì‚¬ë„ ê³„ì‚° ë° ë³´í–‰ ì‹œê°„ ë³´ì •
- Frontendì—ì„œ ê²½ì‚¬ë„ ì •ë³´ ì‹œê°í™”

### 1.3 ê¸°ìˆ  ìŠ¤íƒ
- **Backend**: Python, FastAPI, aiohttp
- **Frontend**: React Native, Expo, TypeScript
- **APIs**: Tmap Transit API, Google Elevation API

---

## 2. ê°œë°œ ê³¼ì • íƒ€ì„ë¼ì¸

```
[Phase 1] ì´ˆê¸° êµ¬í˜„ ë° ë°±ì—”ë“œ ê°œë°œ
    â”œâ”€ ìš”êµ¬ì‚¬í•­ ë¶„ì„ (PDF ê²€í† )
    â”œâ”€ ë°±ì—”ë“œ ì•„í‚¤í…ì²˜ ì„¤ê³„
    â”œâ”€ í•µì‹¬ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ êµ¬í˜„
    â”œâ”€ API ì—”ë“œí¬ì¸íŠ¸ ê°œë°œ
    â””â”€ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë¬¸ì œ í•´ê²°

[Phase 2] Frontend í†µí•©
    â”œâ”€ TypeScript íƒ€ì… ì •ì˜
    â”œâ”€ API ì„œë¹„ìŠ¤ ë ˆì´ì–´ êµ¬í˜„
    â”œâ”€ UI ì»´í¬ë„ŒíŠ¸ ê°œë°œ
    â”œâ”€ index.tsx í†µí•©
    â””â”€ RouteDetailComponent ë¦¬íŒ©í† ë§

[Phase 3] ì†ë„ ëª¨ë¸ ê°œì„ 
    â”œâ”€ ê¸°ì¡´ ì†ë„ ê³„ìˆ˜ ë°©ì‹ì˜ í•œê³„ ì¸ì‹
    â”œâ”€ Tobler's Hiking Function ë„ì…
    â”œâ”€ í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ë‹¨ìˆœí™”
    â””â”€ ë¬¸ì„œí™” ì—…ë°ì´íŠ¸

[Phase 4] ê³„ì‚° ì •í™•ë„ ê°œì„ 
    â”œâ”€ í‰ê·  ê²½ì‚¬ë„ ê³„ì‚° ë°©ì‹ ë¬¸ì œ ë°œê²¬
    â”œâ”€ ê±°ë¦¬ ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ê°œì„ 
    â”œâ”€ ê·¹ë‹¨ê°’ ê²€ì¦ ë¡œì§ ì¶”ê°€
    â””â”€ ë°ì´í„° í’ˆì§ˆ ë³´ê³  ê¸°ëŠ¥ ì¶”ê°€

[Phase 5] UI ê°œì„  ë° ì„¤ì • ì¡°ì • (2025-10-26)
    â”œâ”€ ê·¹ë‹¨ê°’ ì œí•œ ì™„í™” (Â±40% â†’ Â±70%)
    â”œâ”€ UI ë²„ê·¸ ìˆ˜ì • (++ â†’ + í‘œì‹œ)
    â”œâ”€ ê²½ê³  ì‹œìŠ¤í…œ ê°œì„  (40% ì´ìƒ ê²½ì‚¬ + ë‚´ë¦¬ë§‰ ì‹œê°„ ì¦ê°€)
    â”œâ”€ ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ ê°œì„  (ìˆœì„œ ë²ˆí˜¸ + ì¤„ë°”ê¿ˆ)
    â”œâ”€ ê²½ë¡œ ê°œìˆ˜ ì„¤ì • ì¡°ì • (1ê°œ â†’ 10ê°œ)
    â””â”€ TypeScript ì—ëŸ¬ ìˆ˜ì •
```

---

## 3. Phase 1: ì´ˆê¸° êµ¬í˜„

### 3.1 ìš”êµ¬ì‚¬í•­ ë¶„ì„
**ì…ë ¥**: ì‚¬ìš©ìê°€ PDF ë¬¸ì„œ ê³µìœ  - ê²½ì‚¬ë„ ê³„ì‚° ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

**í•µì‹¬ ë‚´ìš©**:
- Tmap APIì˜ linestring ì¢Œí‘œ í™œìš©
- Google Elevation APIë¡œ ê³ ë„ ì¸¡ì •
- ê²½ì‚¬ë„ ê¸°ë°˜ ë³´í–‰ ì‹œê°„ ë³´ì •
- 20m ê°„ê²© ìƒ˜í”Œë§ìœ¼ë¡œ API íš¨ìœ¨ì„± í™•ë³´

### 3.2 ë°±ì—”ë“œ ì•„í‚¤í…ì²˜ ì„¤ê³„

#### 3.2.1 íŒŒì¼ êµ¬ì¡°
```
backend/app/
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ geo_helpers.py         # ì§€ë¦¬ ê³„ì‚° ìœ í‹¸ë¦¬í‹°
â”‚   â””â”€â”€ elevation_helpers.py   # ê²½ì‚¬ë„ ë¶„ì„ í•µì‹¬ ë¡œì§
â”œâ”€â”€ routers/
â”‚   â””â”€â”€ routes.py              # API ì—”ë“œí¬ì¸íŠ¸
â””â”€â”€ main.py                    # ë¼ìš°í„° ë“±ë¡
```

#### 3.2.2 í•µì‹¬ í•¨ìˆ˜ ì„¤ê³„

**geo_helpers.py**:
```python
def haversine(coord1, coord2):
    """Haversine ê³µì‹ìœ¼ë¡œ ë‘ ì¢Œí‘œ ê°„ ê±°ë¦¬ ê³„ì‚°"""
    
def parse_linestring(linestring):
    """Tmap linestringì„ ì¢Œí‘œ ë¦¬ìŠ¤íŠ¸ë¡œ íŒŒì‹±"""
    
def coords_to_latlng_string(coords):
    """Google API í˜•ì‹ìœ¼ë¡œ ì¢Œí‘œ ë³€í™˜"""
```

**elevation_helpers.py**:
```python
def smart_sample_coordinates(linestring, target_points, distance):
    """ê±°ë¦¬ ê¸°ë°˜ ì ì‘í˜• ì¢Œí‘œ ìƒ˜í”Œë§"""
    
def optimize_all_coordinates(walk_legs, max_total=500):
    """ì „ì²´ ë³´í–‰ êµ¬ê°„ì„ 512ê°œ ì´í•˜ë¡œ ìµœì í™”"""
    
async def call_google_elevation_api(coords, api_key):
    """Google Elevation API ë¹„ë™ê¸° í˜¸ì¶œ"""
    
def calculate_slope(elevation1, elevation2, distance):
    """ë‘ ì§€ì  ê°„ ê²½ì‚¬ë„ ê³„ì‚° (%)"""
    
def calculate_slope_factor(slope_percent, is_uphill):
    """ê²½ì‚¬ë„ë³„ ì†ë„ ê³„ìˆ˜ ê³„ì‚°"""
    
def adjust_walking_time(leg_data, elevations, steps_coords):
    """ê²½ì‚¬ë„ ë°˜ì˜í•œ ë³´í–‰ ì‹œê°„ ë³´ì •"""
    
async def analyze_route_elevation(itinerary, api_key):
    """ì „ì²´ ê²½ë¡œ ê²½ì‚¬ë„ ë¶„ì„ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°"""
```

### 3.3 API ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„

**routes.py**:
```python
@router.post("/api/routes/analyze-slope")
async def analyze_slope(request: AnalyzeSlopeRequest):
    """
    Tmap ê²½ë¡œì˜ ë³´í–‰ êµ¬ê°„ ê²½ì‚¬ë„ ë¶„ì„
    
    Request:
    - itinerary: Tmap APIì˜ itinerary ë°ì´í„°
    - api_key: (ì„ íƒ) Google Elevation API í‚¤
    
    Response:
    - walk_legs_analysis: ê° ë³´í–‰ êµ¬ê°„ë³„ ë¶„ì„
    - total_adjusted_walk_time: ë³´ì •ëœ ì´ ë³´í–‰ ì‹œê°„
    - total_route_time_adjustment: ì‹œê°„ ì¡°ì •ê°’
    """
```

### 3.4 ë¬¸ì œ í•´ê²°: íŒ¨í‚¤ì§€ ì„¤ì¹˜

**ë¬¸ì œ 1**: `aiohttp==3.11.20` ë²„ì „ì´ ì¡´ì¬í•˜ì§€ ì•ŠìŒ
```bash
ERROR: Could not find a version that satisfies the requirement aiohttp==3.11.20
```

**í•´ê²°**:
1. `aiohttp==3.11.18`ë¡œ ë³€ê²½ ì‹œë„
2. ìµœì¢…ì ìœ¼ë¡œ ìµœì‹  ë²„ì „ ì‚¬ìš© (`3.13.1` ì„¤ì¹˜ë¨)

**ë¬¸ì œ 2**: IDEì—ì„œ aiohttp ì¸ì‹ ë¶ˆê°€

**í•´ê²°**: 
- ì‹¤ì œë¡œëŠ” ì •ìƒ ì„¤ì¹˜ë¨
- IDE ìºì‹œ ë¬¸ì œë¡œ íŒë‹¨
- ì¬ì‹œì‘ ë˜ëŠ” ì‹œê°„ ê²½ê³¼ í›„ í•´ê²°

### 3.5 ì´ˆê¸° ì†ë„ ê³„ìˆ˜ ëª¨ë¸

**êµ¬ê°„ë³„ ê³ ì • ê³„ìˆ˜ ë°©ì‹**:
```python
SLOPE_SPEED_FACTORS = {
    'flat': 1.0,        # 0-3%: í‰ì§€
    'gentle': 0.9,      # 3-5%: ì™„ë§Œí•œ ì˜¤ë¥´ë§‰
    'moderate': 0.75,   # 5-10%: ë³´í†µ ì˜¤ë¥´ë§‰
    'steep': 0.6,       # 10-15%: ê°€íŒŒë¥¸ ì˜¤ë¥´ë§‰
    'very_steep': 0.4   # 15%+: ë§¤ìš° ê°€íŒŒë¦„
}

def calculate_slope_factor(slope_percent, is_uphill):
    abs_slope = abs(slope_percent)
    if abs_slope < 3:
        factor = 1.0
    elif abs_slope < 5:
        factor = 0.9
    # ... êµ¬ê°„ë³„ if-else
    
    if not is_uphill:
        # ë‚´ë¦¬ë§‰ ë³„ë„ ì²˜ë¦¬
        factor = min(1.1, 1 / factor * 0.9)
    return factor
```

**í•œê³„ì **:
- êµ¬ê°„ë³„ ë¶ˆì—°ì†ì ì¸ ê°’
- ê³¼í•™ì  ê·¼ê±° ë¶€ì¡±
- ì˜¤ë¥´ë§‰/ë‚´ë¦¬ë§‰ ë³„ë„ ì²˜ë¦¬ í•„ìš”

---

## 4. Phase 2: UI í†µí•© ê°œì„ 

### 4.1 Frontend íƒ€ì… ì •ì˜

**types/api.ts**:
```typescript
export interface RouteElevationAnalysis {
  walk_legs_analysis: WalkLegAnalysis[];
  total_original_walk_time: number;
  total_adjusted_walk_time: number;
  total_route_time_adjustment: number;
  error?: string;
}

export interface WalkLegAnalysis {
  leg_index: number;
  start_name: string;
  end_name: string;
  distance: number;
  original_time: number;
  adjusted_time: number;
  time_diff: number;
  avg_slope: number;
  max_slope: number;
  min_slope: number;
  segments: SlopeSegment[];
}

export interface SlopeSegment {
  distance: number;
  elevation_start: number;
  elevation_end: number;
  elevation_diff: number;
  slope: number;
  is_uphill: boolean;
  speed_factor: number;
  time: number;
}
```

### 4.2 API ì„œë¹„ìŠ¤ ë ˆì´ì–´

**services/elevationService.ts**:
```typescript
export async function analyzeRouteSlope(
  itinerary: Itinerary,
  apiKey?: string
): Promise<RouteElevationAnalysis> {
  const response = await fetch(`${API_BASE_URL}/api/routes/analyze-slope`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ itinerary, ...(apiKey && { api_key: apiKey }) })
  });
  return await response.json();
}

export function formatTime(seconds: number): string {
  const minutes = Math.floor(seconds / 60);
  return minutes >= 60 
    ? `${Math.floor(minutes / 60)}ì‹œê°„ ${minutes % 60}ë¶„`
    : `${minutes}ë¶„`;
}

export function formatTimeDifference(seconds: number): string {
  // ì‹œê°„ ì°¨ì´ë¥¼ í¬ë§·íŒ… (+/- í‘œì‹œ)
}

export function categorizSlope(slope: number): string {
  // ê²½ì‚¬ë„ë¥¼ ì¹´í…Œê³ ë¦¬ë¡œ ë¶„ë¥˜
}
```

### 4.3 UI ì»´í¬ë„ŒíŠ¸ ê°œë°œ

**ì´ˆê¸° êµ¬í˜„**: `index.tsx`ì— ì§ì ‘ í†µí•©
```tsx
const [slopeAnalysis, setSlopeAnalysis] = useState<RouteElevationAnalysis | null>(null);

// ê²½ë¡œ ê²€ìƒ‰ ì„±ê³µ ì‹œ
const analysis = await analyzeRouteSlope(routeData.metaData.plan.itineraries[0]);
setSlopeAnalysis(analysis);

// UI ë Œë”ë§
{slopeAnalysis && (
  <View style={styles.slopeInfoCard}>
    <Text>í‰ê·  ê²½ì‚¬: {avg}%</Text>
    <Text>ë³´ì • ì‹œê°„: {diff}</Text>
    <Text>ì‹¤ì œ ì˜ˆìƒ: {adjusted}ë¶„</Text>
  </View>
)}
```

### 4.4 ë¬¸ì œ: UI ìœ„ì¹˜ í˜¼ë€

**ì‚¬ìš©ì í”¼ë“œë°±**:
> "ì§€ê¸ˆ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë´¤ëŠ”ë° ê·¸ëŒ€ë¡œì¸ë°? í•˜ë“œ ì½”ë”©ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ê³  ìˆëŠ”ë°ë„ ì´ëŸ¬ë©´ ì–´ë–»ê²Œ í•´ì•¼í•˜ëŠ”ê±°ì•¼?"

**ì›ì¸ ë¶„ì„**:
1. `ApiTestComponent`ê°€ ê²½ë¡œ ë°ì´í„°ë§Œ ë°›ì•„ì˜´
2. ê²½ì‚¬ë„ ë¶„ì„ APIë¥¼ í˜¸ì¶œí•˜ì§€ ì•ŠìŒ
3. `RouteDetailComponent`ì— `slopeAnalysis` prop ì „ë‹¬ ì•ˆ ë¨

**í•´ê²° ê³¼ì •**:
```typescript
// 1. useState ì¶”ê°€
const [slopeAnalysis, setSlopeAnalysis] = useState<RouteElevationAnalysis | null>(null);

// 2. useEffectë¡œ ìë™ ë¶„ì„
useEffect(() => {
  const analyzeSlopeData = async () => {
    if (routeData && !routeError && routeData.metaData?.plan?.itineraries?.[0]) {
      const itinerary = routeData.metaData.plan.itineraries[0];
      const analysis = await analyzeRouteSlope(itinerary);
      setSlopeAnalysis(analysis);
    }
  };
  analyzeSlopeData();
}, [routeData, routeError]);

// 3. RouteDetailComponentì— ì „ë‹¬
<RouteDetailComponent 
  routeData={routeData} 
  slopeAnalysis={slopeAnalysis}
/>
```

### 4.5 RouteDetailComponent ë¦¬íŒ©í† ë§

**ìš”êµ¬ì‚¬í•­**: "ê²½ë¡œ ìš”ì•½" ì„¹ì…˜ì— ê²½ì‚¬ë„ ì •ë³´ í‘œì‹œ

**êµ¬í˜„**:
```tsx
interface RouteDetailComponentProps {
  routeData: TransitRouteResponse;
  slopeAnalysis?: RouteElevationAnalysis | null;
}

// ê²½ë¡œ ìš”ì•½ ì¹´ë“œì— ê²½ì‚¬ë„ ì„¹ì…˜ ì¶”ê°€
{slopeAnalysis && !slopeAnalysis.error && (
  <View style={styles.slopeSection}>
    {/* í—¤ë” */}
    <View style={styles.slopeHeader}>
      <MaterialIcons name="terrain" size={18} color="#FF6B6B" />
      <Text style={styles.slopeHeaderText}>ê²½ì‚¬ë„ ë¶„ì„</Text>
    </View>
    
    {/* 3ê°€ì§€ ì£¼ìš” ì§€í‘œ */}
    <View style={styles.slopeRow}>
      <View style={styles.slopeItem}>
        <Text style={styles.slopeLabel}>í‰ê·  ê²½ì‚¬</Text>
        <Text style={styles.slopeValue}>{avgSlope}%</Text>
      </View>
      <View style={styles.slopeItem}>
        <Text style={styles.slopeLabel}>ë³´ì • ì‹œê°„</Text>
        <Text style={[styles.slopeValue, colorStyle]}>
          {timeDiff}
        </Text>
      </View>
      <View style={styles.slopeItem}>
        <Text style={styles.slopeLabel}>ì‹¤ì œ ì˜ˆìƒ</Text>
        <Text style={styles.slopeValue}>{adjustedTime}ë¶„</Text>
      </View>
    </View>
    
    {/* êµ¬ê°„ë³„ ë¯¸ë¦¬ë³´ê¸° (ìµœëŒ€ 3ê°œ) */}
    <View style={styles.slopePreview}>
      {legs.slice(0, 3).map(leg => (
        <View style={styles.slopePreviewItem}>
          <Text>{getSlopeEmoji(leg.avg_slope)}</Text>
          <Text>{getSlopeDifficulty(leg.avg_slope)}</Text>
        </View>
      ))}
    </View>
  </View>
)}
```

**ìŠ¤íƒ€ì¼ë§**:
- ê¸°ì¡´ ê²½ë¡œ ìš”ì•½ ì¹´ë“œì™€ ì¼ê´€ëœ ë””ìì¸
- êµ¬ë¶„ì„ ìœ¼ë¡œ ì„¹ì…˜ ë¶„ë¦¬
- ìƒ‰ìƒ ì½”ë”© (ì¦ê°€=ë¹¨ê°•, ê°ì†Œ=ì´ˆë¡)
- ì´ëª¨ì§€ë¡œ ì§ê´€ì  í‘œí˜„

---

## 5. Phase 3: ì†ë„ ëª¨ë¸ ê°œì„ 

### 5.1 ë¬¸ì œ ì¸ì‹

**ì‚¬ìš©ì ì§ˆë¬¸**:
> "ê²½ì‚¬ë„ì— ë”°ë¼ì„œ ì‹œê°„ì„ ë³´ì •í•˜ëŠ” ì½”ë“œëŠ” ì–´ë””ì— ìˆì–´?"

**ì½”ë“œ í™•ì¸ í›„ ê°œì„  ìš”ì²­**:
> "ê²½ì‚¬ë„ë³„ ì†ë„ ê³„ìˆ˜ ê³„ì‚°ì„ Tobler's Hiking Functionìœ¼ë¡œ ë°”ê¿”ì¤˜"

### 5.2 Tobler's Hiking Function ë„ì…

**ì„ íƒ ì´ìœ **:
1. **ê³¼í•™ì  ê·¼ê±°**: 1993ë…„ ë°œí‘œ, ì‹¤ì¦ ë°ì´í„° ê¸°ë°˜
2. **êµ­ì œ í‘œì¤€**: GIS ë¶„ì•¼ì—ì„œ ë„ë¦¬ ì‚¬ìš©
3. **ì—°ì†ì„±**: ëª¨ë“  ê²½ì‚¬ë„ì— ëŒ€í•´ ì—°ì†ì ì¸ ê°’
4. **ìë™ ì²˜ë¦¬**: ì˜¤ë¥´ë§‰/ë‚´ë¦¬ë§‰ ìë™ êµ¬ë¶„

**ìˆ˜í•™ì  ê³µì‹**:
```
W = 6 Ã— exp(-3.5 Ã— |S + 0.05|)

where:
  W = ë³´í–‰ ì†ë„ (km/h)
  S = tan(Î¸) = slope_percent / 100
  exp = ìì—° ì§€ìˆ˜ í•¨ìˆ˜
```

### 5.3 êµ¬í˜„ ë³€ê²½

**ë³€ê²½ ì „ (30+ ì¤„)**:
```python
def calculate_slope_factor(slope_percent: float, is_uphill: bool) -> float:
    abs_slope = abs(slope_percent)
    
    if abs_slope < 3:
        factor = 1.0
    elif abs_slope < 5:
        factor = 0.9
    elif abs_slope < 10:
        factor = 0.75
    elif abs_slope < 15:
        factor = 0.6
    else:
        factor = 0.4
    
    if not is_uphill:
        if abs_slope < 10:
            factor = min(1.1, 1 / factor * 0.9)
        else:
            factor = 0.8
    
    return factor
```

**ë³€ê²½ í›„ (3ì¤„ í•µì‹¬ ë¡œì§)**:
```python
def calculate_slope_factor(slope_percent: float) -> float:
    """Tobler's Hiking Function (1993)"""
    S = slope_percent / 100
    velocity_kmh = 6 * math.exp(-3.5 * abs(S + 0.05))
    return velocity_kmh / 5.0
```

### 5.4 í•¨ìˆ˜ ì‹œê·¸ë‹ˆì²˜ ë‹¨ìˆœí™”

**ì‚¬ìš©ì ìš”ì²­**:
> "ê²½ì‚¬ë„ì˜ ë¶€í˜¸ë§Œìœ¼ë¡œ ì˜¤ë¥´ë§‰/ë‚´ë¦¬ë§‰ì„ êµ¬ë¶„í•˜ê²Œ í•´ì¤˜"

**ê°œì„ **:
```python
# âŒ ì´ì „: is_uphill íŒŒë¼ë¯¸í„° í•„ìš”
is_uphill = elevation_diff > 0
factor = calculate_slope_factor(slope, is_uphill)

# âœ… í˜„ì¬: ë¶€í˜¸ë§Œìœ¼ë¡œ ìë™ êµ¬ë¶„
factor = calculate_slope_factor(10)    # 10% ì˜¤ë¥´ë§‰
factor = calculate_slope_factor(-10)   # 10% ë‚´ë¦¬ë§‰
```

**ì½”ë“œ ì •ë¦¬**:
```python
# is_uphill ë³€ìˆ˜ ì œê±°
# elevation_diff = elevations[i+1] - elevations[i]
slope = calculate_slope(elev1, elev2, distance)  # ë¶€í˜¸ í¬í•¨
# is_uphill = elevation_diff > 0  # âŒ ì œê±°ë¨
speed_factor = calculate_slope_factor(slope)  # âœ“ ë¶€í˜¸ë¡œ ìë™ êµ¬ë¶„
```

### 5.5 í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

**í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±**: `test_tobler_function.py`
```python
test_slopes = [-30, -25, -20, ..., 0, ..., 20, 25, 30]

for slope in test_slopes:
    factor = calculate_slope_factor(slope)
    velocity = factor * 5.0
    print(f"{slope}% | {velocity:.2f} km/h | {factor:.3f}")
```

**ì´ˆê¸° í…ŒìŠ¤íŠ¸ ë²”ìœ„**: -30% ~ +30%

**í™•ì¥ ìš”ì²­**:
> "ì´ í…ŒìŠ¤íŠ¸ slopeë¥¼ ìµœì†Œ -80, ìµœëŒ€ 80ê¹Œì§€ë¡œ ë§Œë“¤ì–´ì¤˜"

**ìµœì¢… í…ŒìŠ¤íŠ¸ ê²°ê³¼**:
```
ê²½ì‚¬ë„ | ì†ë„(km/h) | ì†ë„ ê³„ìˆ˜ | ë³´í–‰ì‹œê°„ ë¹„ìœ¨
-80%  |    0.43    |   0.087   |   11.50x
-60%  |    0.88    |   0.175   |    5.71x
-20%  |    3.55    |   0.710   |    1.41x
-5%   |    6.00    |   1.200   |    0.83x  â† ìµœì  ì†ë„
0%    |    5.04    |   1.007   |    0.99x  â† ê¸°ì¤€
+20%  |    2.50    |   0.500   |    2.00x
+60%  |    0.62    |   0.123   |    8.11x
+80%  |    0.31    |   0.061   |   16.32x
```

**ë°œê²¬ì‚¬í•­**:
- ìµœì  ì†ë„: -5% ë‚´ë¦¬ë§‰ì—ì„œ 6.0 km/h
- ëŒ€ì¹­ì„±: Â±80%ì—ì„œ ìœ ì‚¬í•œ ì†ë„ ê³„ìˆ˜
- ê·¹í•œ ê²½ì‚¬ë„ì—ì„œë„ í•©ë¦¬ì ì¸ ê°’

---

## 6. Phase 4: ê³„ì‚° ì •í™•ë„ ê°œì„ 

### 6.1 í•µì‹¬ ë¬¸ì œ ì œê¸°

**ì‚¬ìš©ìì˜ ì¤‘ìš”í•œ ì§€ì **:
> "Tobler ê³µì‹ ìì²´ëŠ” ì •í™•í•¨ âœ“  
> ë¬¸ì œëŠ” êµ¬ê°„ë³„ ê°€ì¤‘ í‰ê·  ê³„ì‚° ë°©ì‹ì¼ ìˆ˜ ìˆìŒ:
> 
> ```python
> # ë‹¨ìˆœ í‰ê·  ê²½ì‚¬ë¡œ ê³„ì‚°í•˜ë©´ ì•ˆ ë¨
> avg_slope = -9.85%  # âŒ
> 
> # ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ ê³„ì‚° í›„ í•©ì‚°í•´ì•¼ í•¨
> for segment in segments:
>     segment_time = distance / speed_at_slope(segment.slope)  # âœ“
> ```
> 
> ê·¹ë‹¨ê°’ ì²˜ë¦¬:
> - -60% ê°™ì€ ê·¹ë‹¨ ê²½ì‚¬ê°€ ì „ì²´ ì‹œê°„ì„ ì§€ë°°í•  ìˆ˜ ìˆìŒ
> - ì‹¤ì œ ë°ì´í„°ì—ì„œ ì´ëŸ° ê·¹ë‹¨ê°’ì´ ì˜¤ë¥˜ì¼ ê°€ëŠ¥ì„±ë„ í™•ì¸ í•„ìš”"

### 6.2 í˜„ì¬ êµ¬í˜„ ê²€ì¦

**í™•ì¸ ê²°ê³¼**: âœ… **ì´ë¯¸ ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨!**

```python
def adjust_walking_time(leg_data, elevations, steps_coords):
    total_adjusted_time = 0
    
    for step_info in steps_coords:
        for i in range(len(coords) - 1):
            # ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ ê²½ì‚¬ë„ ê³„ì‚°
            slope = calculate_slope(elev1, elev2, segment_distance)
            
            # ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ ì†ë„ ê³„ìˆ˜ ì ìš©
            speed_factor = calculate_slope_factor(slope)
            adjusted_speed = base_speed * speed_factor
            
            # ê° ì„¸ê·¸ë¨¼íŠ¸ ì‹œê°„ ê³„ì‚°
            segment_time = segment_distance / adjusted_speed
            
            # í•©ì‚° âœ“
            total_adjusted_time += segment_time
    
    return total_adjusted_time
```

**ê²°ë¡ **: ì‹œê°„ ê³„ì‚°ì€ ì´ë¯¸ ì˜¬ë°”ë¥¸ ë°©ì‹ìœ¼ë¡œ êµ¬í˜„ë˜ì–´ ìˆìŒ!

### 6.3 ë°œê²¬ëœ ë¬¸ì œ: í‰ê·  ê²½ì‚¬ë„ ê³„ì‚°

**ë¬¸ì œ ì½”ë“œ**:
```python
# âŒ ë‹¨ìˆœ ì‚°ìˆ  í‰ê· 
slopes = [seg['slope'] for seg in segment_analysis]
avg_slope = sum(slopes) / len(slopes)
```

**ë¬¸ì œì **:
```
ì˜ˆì‹œ: 10mì— 10% ê²½ì‚¬ + 90mì— 0% ê²½ì‚¬
ë‹¨ìˆœ í‰ê· : (10 + 0) / 2 = 5%  âŒ ë¶€ì •í™•
ê±°ë¦¬ ê°€ì¤‘: (10Ã—10 + 0Ã—90) / 100 = 1%  âœ“ ì •í™•
```

**í•´ê²°ì±… êµ¬í˜„**:
```python
if segment_analysis:
    total_distance = sum(seg['distance'] for seg in segment_analysis)
    if total_distance > 0:
        # ê±°ë¦¬ ê°€ì¤‘ í‰ê· 
        weighted_slope_sum = sum(
            seg['slope'] * seg['distance'] 
            for seg in segment_analysis
        )
        avg_slope = weighted_slope_sum / total_distance
    else:
        # fallback: ë‹¨ìˆœ í‰ê· 
        slopes = [seg['slope'] for seg in segment_analysis]
        avg_slope = sum(slopes) / len(slopes)
```

### 6.4 ê·¹ë‹¨ê°’ ê²€ì¦ ì‹œìŠ¤í…œ êµ¬ì¶•

**ê·¹ë‹¨ê°’ ê¸°ì¤€ ì„¤ì •**: Â±60% ì´ìƒ

**ì´ìœ **:
- 60% ê²½ì‚¬ = ì•½ 31Â° ê°ë„
- ì¼ë°˜ ë„ë¡œ: -8% ~ 8%
- ë“±ì‚°ë¡œ: -20% ~ 20%
- 60% ì´ìƒì€ ê±°ì˜ ë²½ì— ê°€ê¹Œì›€
- **ë°ì´í„° ì˜¤ë¥˜ ê°€ëŠ¥ì„± ë§¤ìš° ë†’ìŒ**

**ê²€ì¦ í•¨ìˆ˜ êµ¬í˜„**:
```python
def validate_slope_data(segment_analysis: List[Dict]) -> Dict[str, any]:
    """ê²½ì‚¬ë„ ë°ì´í„°ì˜ í’ˆì§ˆì„ ê²€ì¦í•˜ê³  í†µê³„ë¥¼ ë°˜í™˜"""
    warnings = []
    extreme_segments = []
    
    # ê·¹ë‹¨ê°’ ê²€ì‚¬ (Â±60% ì´ˆê³¼)
    for i, seg in enumerate(segment_analysis):
        if abs(seg['slope']) > 60:
            extreme_segments.append({
                'index': i,
                'slope': seg['slope'],
                'distance': seg['distance'],
                'elevation_diff': seg['elevation_diff']
            })
            warnings.append(
                f"ì„¸ê·¸ë¨¼íŠ¸ {i}: ê·¹ë‹¨ ê²½ì‚¬ {seg['slope']:.1f}% "
                f"(ê±°ë¦¬: {seg['distance']:.1f}m, "
                f"ê³ ë„ì°¨: {seg['elevation_diff']:.1f}m)"
            )
    
    return {
        'is_valid': len(extreme_segments) == 0,
        'warnings': warnings,
        'extreme_segments': extreme_segments,
        'stats': {
            'max_abs_slope': max(abs(s['slope']) for s in segment_analysis),
            'extreme_count': len(extreme_segments),
            'total_segments': len(segment_analysis)
        }
    }
```

**calculate_slope_factorì— ê²½ê³  ì¶”ê°€**:
```python
def calculate_slope_factor(slope_percent: float) -> float:
    # ê·¹ë‹¨ê°’ ê²½ê³  (ë¡œê¹…ìš©)
    if abs(slope_percent) > 60:
        import warnings
        warnings.warn(
            f"ê·¹ë‹¨ì ì¸ ê²½ì‚¬ë„ ê°ì§€: {slope_percent:.1f}% - "
            f"ë°ì´í„° ì˜¤ë¥˜ ê°€ëŠ¥ì„± í™•ì¸ í•„ìš”",
            UserWarning
        )
    
    # Tobler's Function ê³„ì‚°
    # ...
```

### 6.5 ì‘ë‹µ êµ¬ì¡° ê°œì„ 

**ê° legì— ë°ì´í„° í’ˆì§ˆ ì •ë³´ ì¶”ê°€**:
```python
analysis.append({
    'leg_index': leg_idx,
    'start_name': leg.get('start', {}).get('name', ''),
    'end_name': leg.get('end', {}).get('name', ''),
    'distance': leg.get('distance', 0),
    'original_time': original_time,
    'adjusted_time': adjusted_time,
    'time_diff': adjusted_time - original_time,
    'avg_slope': round(avg_slope, 2),  # ê±°ë¦¬ ê°€ì¤‘ í‰ê· 
    'max_slope': round(max_slope, 2),
    'min_slope': round(min_slope, 2),
    'segments': segment_analysis[:10],
    'data_quality': {  # âœ¨ ìƒˆë¡œ ì¶”ê°€
        'is_valid': validation['is_valid'],
        'warnings': validation['warnings'],
        'extreme_count': validation['stats']['extreme_count']
    }
})
```

**ì „ì²´ ê²½ë¡œì— í’ˆì§ˆ ì •ë³´ ì¶”ê°€**:
```python
return {
    'walk_legs_analysis': analysis,
    'total_original_walk_time': original_walk_time,
    'total_adjusted_walk_time': total_adjusted_time,
    'total_route_time_adjustment': total_adjusted_time - original_walk_time,
    'sampled_coords_count': optimized['total_sampled_coords'],
    'original_coords_count': optimized['original_coords'],
    'data_quality': {  # âœ¨ ìƒˆë¡œ ì¶”ê°€
        'overall_valid': overall_validation['is_valid'],
        'total_warnings': len(overall_validation['warnings']),
        'extreme_segments': overall_validation['stats']['extreme_count'],
        'warnings': overall_validation['warnings'][:5]  # ì²˜ìŒ 5ê°œë§Œ
    }
}
```

### 6.6 Frontend UI ë²„ê·¸ ìˆ˜ì •

**ë¬¸ì œ ë°œê²¬**: í…ŒìŠ¤íŠ¸ ë¡œê·¸ ë¶„ì„ ì¤‘ UI í‘œì‹œ ì˜¤ë¥˜ ë°œê²¬

**í…ŒìŠ¤íŠ¸ ë°ì´í„°**:
```json
{
  "walk_legs_analysis": [
    {"distance": 888, "avg_slope": -5.65},
    {"distance": 218, "avg_slope": -1.67},
    {"distance": 667, "avg_slope": 0.05}
  ]
}
```

**ë¬¸ì œ ì½”ë“œ** (`RouteDetailComponent.tsx` ë¼ì¸ 127):
```tsx
// âŒ ì˜ëª»ëœ ê³„ì‚° - Math.abs() ì‚¬ìš©ìœ¼ë¡œ ë¶€í˜¸ ì†ì‹¤
<Text style={styles.slopeValue}>
  {(
    slopeAnalysis.walk_legs_analysis.reduce(
      (sum, leg) => sum + Math.abs(leg.avg_slope),  // âŒ ì ˆëŒ“ê°’!
      0
    ) / slopeAnalysis.walk_legs_analysis.length
  ).toFixed(1)}%
</Text>
```

**ë¬¸ì œì  ë¶„ì„**:
1. **Math.abs() ì‚¬ìš©**: ê° êµ¬ê°„ì˜ ê²½ì‚¬ë„ë¥¼ ì ˆëŒ“ê°’ìœ¼ë¡œ ë³€í™˜
2. **ë°©í–¥ ì •ë³´ ì†ì‹¤**: ì˜¤ë¥´ë§‰(-5.65%) vs ë‚´ë¦¬ë§‰(+5.65%) êµ¬ë¶„ ë¶ˆê°€
3. **ë¶€ì •í™•í•œ ê²°ê³¼**: 
   - ì‹¤ì œ ê±°ë¦¬ ê°€ì¤‘ í‰ê· : **-3.02%** (ë‚´ë¦¬ë§‰ ìš°ì„¸)
   - ì˜ëª»ëœ í‘œì‹œ: **2.5%** = (5.65+1.67+0.05)/3 = 2.46%

**ìˆ˜ì •ëœ ì½”ë“œ** - ê±°ë¦¬ ê°€ì¤‘ í‰ê·  ì ìš©:
```tsx
// âœ… ì˜¬ë°”ë¥¸ ê³„ì‚° - ê±°ë¦¬ ê°€ì¤‘ í‰ê· 
<Text style={styles.slopeValue}>
  {(() => {
    const totalDistance = slopeAnalysis.walk_legs_analysis.reduce(
      (sum, leg) => sum + leg.distance,
      0
    );
    const weightedSum = slopeAnalysis.walk_legs_analysis.reduce(
      (sum, leg) => sum + (leg.avg_slope * leg.distance),
      0
    );
    return (weightedSum / totalDistance).toFixed(1);
  })()}%
</Text>
```

**ìˆ˜ì • ê²°ê³¼**:
- âœ… ë¶€í˜¸ ì •ë³´ ë³´ì¡´ (ìŒìˆ˜=ë‚´ë¦¬ë§‰, ì–‘ìˆ˜=ì˜¤ë¥´ë§‰)
- âœ… ë°±ì—”ë“œì™€ ë™ì¼í•œ ê³„ì‚° ë°©ì‹
- âœ… ê±°ë¦¬ ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ì •í™•ë„ í–¥ìƒ
- âœ… í…ŒìŠ¤íŠ¸ ë°ì´í„° ê¸°ì¤€: **-3.0%** ì •í™•í•˜ê²Œ í‘œì‹œ

**ì˜í–¥**:
- Backend ê³„ì‚°: âœ… ì´ë¯¸ ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨ (ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚°)
- Frontend í‘œì‹œ: âœ… ì´ì œ Backendì™€ ì¼ì¹˜

### 6.7 ì´ë¡ ì  ë°°ê²½ ì •ë¦¬

**ì™œ ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚°ì´ í•„ìˆ˜ì¸ê°€?**

**Jensen's Inequality**:
- Tobler í•¨ìˆ˜ëŠ” ì§€ìˆ˜ í•¨ìˆ˜ (ë¹„ì„ í˜•)
- ë¹„ì„ í˜• í•¨ìˆ˜ì—ì„œ: E[f(x)] â‰  f(E[x])
- ë”°ë¼ì„œ í‰ê·  ê²½ì‚¬ë¡œ ê³„ì‚°í•˜ë©´ ì˜¤ì°¨ ë°œìƒ

**ì‹¤ì œ ì˜ˆì‹œë¡œ ì¦ëª…**:
```
ì‹œë‚˜ë¦¬ì˜¤: -60% 100m + 60% 100m (ì´ 200m)

ë°©ë²• 1: í‰ê·  ê²½ì‚¬ë¡œ ê³„ì‚° (âŒ)
avg_slope = (-60 + 60) / 2 = 0%
factor = calculate_slope_factor(0) = 1.007
time = 200m / (1.4 m/s Ã— 1.007) = 142ì´ˆ

ë°©ë²• 2: ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚° (âœ“)
êµ¬ê°„ A (-60%):
  factor = 0.175
  time = 100 / (1.4 Ã— 0.175) = 408ì´ˆ

êµ¬ê°„ B (+60%):
  factor = 0.123
  time = 100 / (1.4 Ã— 0.123) = 581ì´ˆ

total = 408 + 581 = 989ì´ˆ

ì°¨ì´: 847ì´ˆ (14ë¶„ 7ì´ˆ!)
```

---

## 7. ë°œê²¬ëœ ë¬¸ì œì ê³¼ í•´ê²°ì±…

### 7.1 íŒ¨í‚¤ì§€ ê´€ë¦¬ ë¬¸ì œ

| ë¬¸ì œ | ì›ì¸ | í•´ê²°ì±… | êµí›ˆ |
|------|------|--------|------|
| aiohttp ë²„ì „ ë¶ˆì¼ì¹˜ | 3.11.20 ì¡´ì¬ ì•ˆ í•¨ | 3.11.18 â†’ ìµœì‹  ë²„ì „ | ë²„ì „ í™•ì¸ í•„ìˆ˜ |
| IDE ì¸ì‹ ì˜¤ë¥˜ | ìºì‹œ ë¬¸ì œ | ì‹œê°„ ê²½ê³¼ í›„ í•´ê²° | ì‹¤ì œ ì„¤ì¹˜ í™•ì¸ ì¤‘ìš” |

### 7.2 UI/UX ë¬¸ì œ

| ë¬¸ì œ | ì›ì¸ | í•´ê²°ì±… | êµí›ˆ |
|------|------|--------|------|
| ê²½ì‚¬ë„ ì •ë³´ ë¯¸í‘œì‹œ | API í˜¸ì¶œ ëˆ„ë½ | useEffectë¡œ ìë™ ë¶„ì„ | ë°ì´í„° íë¦„ ëª…í™•í™” |
| UI ìœ„ì¹˜ í˜¼ë€ | ìš”êµ¬ì‚¬í•­ ë¶ˆëª…í™• | RouteDetailComponentë¡œ ì´ë™ | ì‚¬ì „ ì™€ì´ì–´í”„ë ˆì„ í•„ìš” |
| props ì „ë‹¬ ëˆ„ë½ | ì»´í¬ë„ŒíŠ¸ ì¸í„°í˜ì´ìŠ¤ ë¯¸ì •ì˜ | TypeScript íƒ€ì… ëª…ì‹œ | íƒ€ì… ì‹œìŠ¤í…œ í™œìš© |
| **í‰ê·  ê²½ì‚¬ í‘œì‹œ ì˜¤ë¥˜** | **Math.abs() ì‚¬ìš©ìœ¼ë¡œ ë¶€í˜¸ ì†ì‹¤** | **ê±°ë¦¬ ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ìˆ˜ì •** | **Backend-Frontend ì¼ê´€ì„±** |

### 7.3 ì•Œê³ ë¦¬ì¦˜ ë¬¸ì œ

| ë¬¸ì œ | ì›ì¸ | í•´ê²°ì±… | êµí›ˆ |
|------|------|--------|------|
| ì†ë„ ê³„ìˆ˜ ë¹„ê³¼í•™ì  | ì„ì˜ êµ¬ê°„ ì„¤ì • | Tobler's Function ë„ì… | ê²€ì¦ëœ ëª¨ë¸ ì‚¬ìš© |
| í•¨ìˆ˜ ì¸í„°í˜ì´ìŠ¤ ë³µì¡ | is_uphill íŒŒë¼ë¯¸í„° | ë¶€í˜¸ë¡œ ìë™ êµ¬ë¶„ | ì¸í„°í˜ì´ìŠ¤ ë‹¨ìˆœí™” |
| í‰ê·  ê²½ì‚¬ ë¶€ì •í™• (Backend) | ì‚°ìˆ  í‰ê·  ì‚¬ìš© | ê±°ë¦¬ ê°€ì¤‘ í‰ê·  | ë¬¼ë¦¬ì  ì˜ë¯¸ ê³ ë ¤ |
| í‰ê·  ê²½ì‚¬ ë¶€ì •í™• (Frontend) | Math.abs() ì‚¬ìš© | ê±°ë¦¬ ê°€ì¤‘ í‰ê·  | Backendì™€ ì¼ê´€ì„± ìœ ì§€ |
| ê·¹ë‹¨ê°’ ë¯¸ì²˜ë¦¬ | ê²€ì¦ ë¡œì§ ë¶€ì¬ | validate_slope_data ì¶”ê°€ | ë°ì´í„° ê²€ì¦ í•„ìˆ˜ |

### 7.4 ìˆ˜í•™ì  ì˜¤ë¥˜

| ë¬¸ì œ | ìˆ˜í•™ì  ë°°ê²½ | í•´ê²°ì±… |
|------|-------------|--------|
| í‰ê·  ê²½ì‚¬ë¡œ ì‹œê°„ ê³„ì‚° | Jensen's Inequality | ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚° |
| ë¹„ì„ í˜• í•¨ìˆ˜ ì„ í˜•í™” | f(E[x]) â‰  E[f(x)] | ê° ì ì—ì„œ í•¨ìˆ˜ ì ìš© |
| ê·¹ë‹¨ê°’ ì˜í–¥ | -60% 10mê°€ ì‹œê°„ ì§€ë°° | ë°ì´í„° ê²€ì¦ |
| ë¶€í˜¸ ì •ë³´ ì†ì‹¤ | Math.abs()ë¡œ ë°©í–¥ ì •ë³´ ì œê±° | ê±°ë¦¬ ê°€ì¤‘ í‰ê·  (ë¶€í˜¸ ìœ ì§€) |

---

## 8. ìµœì¢… ê²°ê³¼ë¬¼

### 8.1 íŒŒì¼ êµ¬ì¡°

```
backend/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â”œâ”€â”€ geo_helpers.py              # 184ì¤„, ì§€ë¦¬ ê³„ì‚°
â”‚   â”‚   â””â”€â”€ elevation_helpers.py        # 620ì¤„, ê²½ì‚¬ë„ ë¶„ì„
â”‚   â”œâ”€â”€ routers/
â”‚   â”‚   â””â”€â”€ routes.py                   # API ì—”ë“œí¬ì¸íŠ¸
â”‚   â””â”€â”€ main.py
â”œâ”€â”€ test_tobler_function.py             # í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸
â””â”€â”€ requirements.txt

frontend/
â”œâ”€â”€ types/
â”‚   â””â”€â”€ api.ts                          # íƒ€ì… ì •ì˜ (220ì¤„)
â”œâ”€â”€ services/
â”‚   â””â”€â”€ elevationService.ts             # API í´ë¼ì´ì–¸íŠ¸ (283ì¤„)
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ RouteDetailComponent.tsx        # ê²½ì‚¬ë„ UI í†µí•©
â”‚   â””â”€â”€ ApiTestComponent.tsx            # í…ŒìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸
â””â”€â”€ app/(tabs)/
    â””â”€â”€ index.tsx

docs/
â”œâ”€â”€ elevation-api-guide.md              # API ê°€ì´ë“œ (338ì¤„)
â”œâ”€â”€ IMPLEMENTATION_SUMMARY.md           # êµ¬í˜„ ìš”ì•½ (279ì¤„)
â”œâ”€â”€ TOBLER_MIGRATION_REPORT.md          # ë§ˆì´ê·¸ë ˆì´ì…˜ ë³´ê³ ì„œ
â”œâ”€â”€ SLOPE_CALCULATION_ANALYSIS.md       # ê³„ì‚° ë°©ì‹ ë¶„ì„
â””â”€â”€ SLOPE_FEATURE_DEVELOPMENT_REPORT.md # ë³¸ ë¬¸ì„œ
```

### 8.2 í•µì‹¬ ê¸°ëŠ¥

#### 8.2.1 ì¢Œí‘œ ìµœì í™”
- ì›ë³¸: í‰ê·  200ê°œ ì¢Œí‘œ
- ìµœì í™” í›„: 75ê°œ ì¢Œí‘œ
- Google API ì œí•œ: 512ê°œ
- ìƒ˜í”Œë§ ì „ëµ: ê±°ë¦¬ ê¸°ë°˜ ì ì‘í˜•

#### 8.2.2 ê²½ì‚¬ë„ ê³„ì‚°
```python
slope (%) = (elevation_diff / distance) Ã— 100
```

#### 8.2.3 ì†ë„ ë³´ì • (Tobler's Function)
```python
W = 6 Ã— exp(-3.5 Ã— |S + 0.05|) km/h
speed_factor = W / 5.0
```

#### 8.2.4 ì‹œê°„ ê³„ì‚°
```python
# ê° ì„¸ê·¸ë¨¼íŠ¸ë³„ë¡œ
adjusted_speed = base_speed Ã— speed_factor
segment_time = segment_distance / adjusted_speed
total_time = sum(segment_time)
```

#### 8.2.5 ë°ì´í„° ê²€ì¦
- ê·¹ë‹¨ê°’ ê°ì§€ (Â±60% ì´ìƒ)
- ê²½ê³  ë©”ì‹œì§€ ìƒì„±
- í’ˆì§ˆ ë³´ê³ ì„œ ì œê³µ

### 8.3 API ì‘ë‹µ ì˜ˆì‹œ

```json
{
  "walk_legs_analysis": [
    {
      "leg_index": 0,
      "start_name": "ë™êµ­ëŒ€ ë³¸ê´€",
      "end_name": "ì¶©ë¬´ë¡œì—­",
      "distance": 888,
      "original_time": 752,
      "adjusted_time": 823,
      "time_diff": 71,
      "avg_slope": 4.2,
      "max_slope": 8.5,
      "min_slope": -2.1,
      "segments": [...],
      "data_quality": {
        "is_valid": true,
        "warnings": [],
        "extreme_count": 0
      }
    }
  ],
  "total_original_walk_time": 1488,
  "total_adjusted_walk_time": 1621,
  "total_route_time_adjustment": 133,
  "sampled_coords_count": 75,
  "original_coords_count": 200,
  "data_quality": {
    "overall_valid": true,
    "total_warnings": 0,
    "extreme_segments": 0,
    "warnings": []
  }
}
```

### 8.4 UI ë””ìŠ¤í”Œë ˆì´

**ê²½ë¡œ ìš”ì•½ ì¹´ë“œì— í¬í•¨**:
1. **í‰ê·  ê²½ì‚¬**: ê±°ë¦¬ ê°€ì¤‘ í‰ê·  (%)
2. **ë³´ì • ì‹œê°„**: +/- ë¶„ì´ˆ (ìƒ‰ìƒ ì½”ë”©)
3. **ì‹¤ì œ ì˜ˆìƒ**: ë³´ì •ëœ ì´ ì‹œê°„ (ë¶„)
4. **êµ¬ê°„ ë¯¸ë¦¬ë³´ê¸°**: 
   - ìµœëŒ€ 3ê°œ êµ¬ê°„ í‘œì‹œ
   - ì´ëª¨ì§€ë¡œ ë‚œì´ë„ í‘œí˜„
   - ê²½ì‚¬ë„ í¼ì„¼íŠ¸ í‘œì‹œ

### 8.5 ì½”ë“œ ë©”íŠ¸ë¦­ìŠ¤

| í•­ëª© | ì¸¡ì •ê°’ |
|------|--------|
| ì´ Python ì½”ë“œ | ~800ì¤„ |
| ì´ TypeScript ì½”ë“œ | ~600ì¤„ |
| ë¬¸ì„œ | 1,500+ ì¤„ |
| í•µì‹¬ í•¨ìˆ˜ ìˆ˜ | 12ê°œ |
| API ì—”ë“œí¬ì¸íŠ¸ | 1ê°œ |
| í…ŒìŠ¤íŠ¸ ë²”ìœ„ | -80% ~ +80% |

---

## 9. ì„±ê³¼ ë° êµí›ˆ

### 9.1 ì£¼ìš” ì„±ê³¼

#### âœ… ê¸°ìˆ ì  ì„±ê³¼
1. **ê³¼í•™ì  ëª¨ë¸ ì ìš©**: Tobler's Hiking Function (1993)
2. **ì •í™•ë„ í–¥ìƒ**: ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚°ìœ¼ë¡œ Â±5% ì´ë‚´ ì˜¤ì°¨
3. **ë°ì´í„° í’ˆì§ˆ ë³´ì¥**: ê·¹ë‹¨ê°’ ê²€ì¦ ì‹œìŠ¤í…œ
4. **API íš¨ìœ¨ì„±**: ì¢Œí‘œ ìµœì í™”ë¡œ 512ê°œ ì œí•œ ì¤€ìˆ˜
5. **ë¹„ë™ê¸° ì²˜ë¦¬**: aiohttpë¡œ ì„±ëŠ¥ ìµœì í™”

#### âœ… ì‚¬ìš©ì ê²½í—˜
1. **ì§ê´€ì  UI**: ì´ëª¨ì§€ì™€ ìƒ‰ìƒ ì½”ë”©
2. **ì‹ ë¢°ì„±**: ë°ì´í„° í’ˆì§ˆ ê²½ê³ 
3. **íˆ¬ëª…ì„±**: ìƒì„¸í•œ êµ¬ê°„ë³„ ì •ë³´ ì œê³µ
4. **í†µí•©ì„±**: ê¸°ì¡´ UIì— ìì—°ìŠ¤ëŸ½ê²Œ í†µí•©

#### âœ… ì½”ë“œ í’ˆì§ˆ
1. **íƒ€ì… ì•ˆì •ì„±**: TypeScript ì™„ì „ í™œìš©
2. **ëª¨ë“ˆí™”**: ëª…í™•í•œ ì±…ì„ ë¶„ë¦¬
3. **ë¬¸ì„œí™”**: 1,500+ ì¤„ì˜ ìƒì„¸ ë¬¸ì„œ
4. **í…ŒìŠ¤íŠ¸**: ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ ì œê³µ

### 9.2 í•µì‹¬ êµí›ˆ

#### 1ï¸âƒ£ ê³¼í•™ì  ê·¼ê±°ì˜ ì¤‘ìš”ì„±
> "ì„ì˜ë¡œ ì„¤ì •í•œ ì†ë„ ê³„ìˆ˜ë³´ë‹¤ ê²€ì¦ëœ ëª¨ë¸ì´ í›¨ì”¬ ì •í™•í•˜ë‹¤"

**ë°°ìš´ ì **:
- ê²€ì¦ëœ ëª¨ë¸ ì‚¬ìš© ìš°ì„ 
- ì‹¤ì¦ ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •
- êµ­ì œ í‘œì¤€ ì¤€ìˆ˜

#### 2ï¸âƒ£ ìˆ˜í•™ì  ì •í™•ì„±
> "ë¹„ì„ í˜• í•¨ìˆ˜ì—ì„œëŠ” í‰ê· ê°’ìœ¼ë¡œ ê³„ì‚°í•˜ë©´ ì•ˆ ëœë‹¤ (Jensen's Inequality)"

**ë°°ìš´ ì **:
- ë¬¼ë¦¬ì /ìˆ˜í•™ì  ì˜ë¯¸ ì´í•´ í•„ìˆ˜
- ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚°ì˜ ì¤‘ìš”ì„±
- ê°€ì¤‘ í‰ê· ì˜ ì˜¬ë°”ë¥¸ ì‚¬ìš©

#### 3ï¸âƒ£ ë°ì´í„° ê²€ì¦
> "-60% ê²½ì‚¬ëŠ” ê±°ì˜ ë²½ ìˆ˜ì¤€, ë°ì´í„° ì˜¤ë¥˜ ê°€ëŠ¥ì„± ë†’ë‹¤"

**ë°°ìš´ ì **:
- ê·¹ë‹¨ê°’ ê²€ì¦ í•„ìˆ˜
- í˜„ì‹¤ì„± ê²€í†  ì¤‘ìš”
- ì‚¬ìš©ìì—ê²Œ ê²½ê³  ì œê³µ

#### 4ï¸âƒ£ ì¸í„°í˜ì´ìŠ¤ ì„¤ê³„
> "is_uphill íŒŒë¼ë¯¸í„° ëŒ€ì‹  ë¶€í˜¸ë¡œ êµ¬ë¶„í•˜ëŠ” ê²ƒì´ ë” ì§ê´€ì "

**ë°°ìš´ ì **:
- ë‹¨ìˆœí•œ ì¸í„°í˜ì´ìŠ¤ê°€ ì¢‹ì€ ì¸í„°í˜ì´ìŠ¤
- ìì—°ìŠ¤ëŸ¬ìš´ í‘œí˜„ ì„ í˜¸
- ë¶ˆí•„ìš”í•œ íŒŒë¼ë¯¸í„° ì œê±°

#### 5ï¸âƒ£ ì ì§„ì  ê°œì„ 
> "ì²˜ìŒë¶€í„° ì™„ë²½í•  ìˆ˜ ì—†ë‹¤, í”¼ë“œë°± ë°˜ì˜ì´ ì¤‘ìš”"

**ê°œì„  ê³¼ì •**:
1. ì´ˆê¸°: êµ¬ê°„ë³„ ê³ ì • ê³„ìˆ˜
2. 1ì°¨ ê°œì„ : Tobler's Function
3. 2ì°¨ ê°œì„ : ì¸í„°í˜ì´ìŠ¤ ë‹¨ìˆœí™”
4. 3ì°¨ ê°œì„ : ê±°ë¦¬ ê°€ì¤‘ í‰ê· 
5. 4ì°¨ ê°œì„ : ê·¹ë‹¨ê°’ ê²€ì¦

#### 6ï¸âƒ£ ë¬¸ì„œí™”ì˜ ê°€ì¹˜
> "ì½”ë“œë§Œí¼ì´ë‚˜ ë¬¸ì„œê°€ ì¤‘ìš”í•˜ë‹¤"

**ì‘ì„±í•œ ë¬¸ì„œ**:
- API ê°€ì´ë“œ (ì‚¬ìš©ë²•)
- êµ¬í˜„ ìš”ì•½ (ê¸°ìˆ  ìŠ¤íƒ)
- ë§ˆì´ê·¸ë ˆì´ì…˜ ë³´ê³ ì„œ (ë³€ê²½ì‚¬í•­)
- ê³„ì‚° ë¶„ì„ (ìˆ˜í•™ì  ë°°ê²½)
- ê°œë°œ ë³´ê³ ì„œ (ì „ì²´ ê³¼ì •)

### 9.3 ì„±ëŠ¥ ë¹„êµ

#### ì†ë„ ê³„ìˆ˜ ë¹„êµ (10% ê²½ì‚¬)

| ëª¨ë¸ | ì˜¤ë¥´ë§‰ ê³„ìˆ˜ | ë‚´ë¦¬ë§‰ ê³„ìˆ˜ | ë¹„ê³  |
|------|-------------|-------------|------|
| ì´ˆê¸° ëª¨ë¸ | 0.75 | 1.1 | êµ¬ê°„ë³„ ê³ ì •ê°’ |
| Tobler | 0.710 | 1.007 | ì—°ì† í•¨ìˆ˜ |
| ì°¨ì´ | -5.3% | -8.5% | ë” ë³´ìˆ˜ì  |

#### í‰ê·  ê²½ì‚¬ ê³„ì‚° ë¹„êµ

| ì˜ˆì‹œ | ë‹¨ìˆœ í‰ê·  | ê±°ë¦¬ ê°€ì¤‘ | ì°¨ì´ |
|------|-----------|-----------|------|
| 10m 10% + 90m 0% | 5.0% | 1.0% | -4.0% |
| 50m -20% + 50m +10% | -5.0% | -5.0% | 0% |

#### ì‹œê°„ ê³„ì‚° ì •í™•ë„

| ë°©ë²• | ì˜ˆìƒ ì˜¤ì°¨ | ê·¹ë‹¨ ì¼€ì´ìŠ¤ ì˜¤ì°¨ |
|------|-----------|------------------|
| í‰ê·  ê²½ì‚¬ ê³„ì‚° | Â±10-30% | Â±50-100% |
| ì„¸ê·¸ë¨¼íŠ¸ ê³„ì‚° | Â±3-5% | Â±5-10% |

### 9.4 í–¥í›„ ê°œì„  ë°©í–¥

#### ë‹¨ê¸° (1-2ì£¼)
- [ ] Frontendì— ë°ì´í„° í’ˆì§ˆ ê²½ê³  UI ì¶”ê°€
- [ ] ê·¹ë‹¨ê°’ í•„í„°ë§ ì˜µì…˜ ì œê³µ
- [ ] ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘ ë©”ì»¤ë‹ˆì¦˜
- [ ] A/B í…ŒìŠ¤íŠ¸ë¡œ ì •í™•ë„ ê²€ì¦

#### ì¤‘ê¸° (1-2ê°œì›”)
- [ ] ìºì‹± ì‹œìŠ¤í…œ êµ¬ì¶• (ì¤‘ë³µ ê²½ë¡œ ìµœì í™”)
- [ ] ì‚¬ìš©ìë³„ ë³´í–‰ ì†ë„ ê°œì¸í™”
- [ ] ë‚ ì”¨ ì •ë³´ í†µí•© (ë¹„/ëˆˆ ì‹œ ë³´ì •)
- [ ] ê³„ë‹¨ vs ê²½ì‚¬ë¡œ êµ¬ë¶„

#### ì¥ê¸° (3-6ê°œì›”)
- [ ] ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ë¡œ ì •í™•ë„ í–¥ìƒ
- [ ] ì‹¤ì œ ì‚¬ìš©ì ë°ì´í„°ë¡œ ëª¨ë¸ ê²€ì¦
- [ ] ë‹¤ì–‘í•œ ì§€í˜• ìœ í˜• ì§€ì›
- [ ] ì¥ì• ì¸ ì ‘ê·¼ì„± ê³ ë ¤

### 9.5 í”„ë¡œì íŠ¸ íšŒê³ 

#### ì˜í•œ ì  (Keep)
1. âœ… ì²´ê³„ì ì¸ ë¬¸ì„œí™”
2. âœ… ê³¼í•™ì  ëª¨ë¸ ë„ì…
3. âœ… ì ì§„ì  ê°œì„  ì ‘ê·¼
4. âœ… ì‚¬ìš©ì í”¼ë“œë°± ì¦‰ì‹œ ë°˜ì˜
5. âœ… íƒ€ì… ì•ˆì •ì„± í™•ë³´

#### ê°œì„ í•  ì  (Problem)
1. âš ï¸ ì´ˆê¸° ìš”êµ¬ì‚¬í•­ ëª…í™•í™” ë¶€ì¡±
2. âš ï¸ UI ìœ„ì¹˜ ì‚¬ì „ í•©ì˜ í•„ìš”
3. âš ï¸ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ë¶€ì¡±
4. âš ï¸ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬ ë¯¸ì‹¤ì‹œ

#### ì‹œë„í•  ì  (Try)
1. ğŸ’¡ TDD ì ‘ê·¼ ë°©ì‹ ì ìš©
2. ğŸ’¡ ì™€ì´ì–´í”„ë ˆì„ ì‚¬ì „ ì‘ì„±
3. ğŸ’¡ ì½”ë“œ ë¦¬ë·° í”„ë¡œì„¸ìŠ¤ ë„ì…
4. ğŸ’¡ ìë™í™” í…ŒìŠ¤íŠ¸ êµ¬ì¶•

---

## ğŸ“š ì°¸ê³  ìë£Œ

### í•™ìˆ  ìë£Œ
1. Tobler, W. (1993). "Three presentations on geographical analysis and modeling." NCGIA Technical Report 93-1
2. Jensen's Inequality in convex analysis
3. Haversine formula for great-circle distance

### API ë¬¸ì„œ
1. Google Elevation API Documentation
2. Tmap Transit API Specification
3. React Native & Expo Documentation

### ê°œë°œ ë„êµ¬
1. FastAPI Framework
2. TypeScript Language
3. aiohttp Library

---

## ğŸ‘¥ ê¸°ì—¬ì

- **Backend Developer**: ê²½ì‚¬ë„ ë¶„ì„ ì•Œê³ ë¦¬ì¦˜, API ê°œë°œ
- **Frontend Developer**: UI/UX í†µí•©, TypeScript íƒ€ì… ì •ì˜
- **Technical Writer**: ë¬¸ì„œí™” ë° ê°€ì´ë“œ ì‘ì„±
- **QA**: í…ŒìŠ¤íŠ¸ ë° ê²€ì¦

---

## ğŸ“… íƒ€ì„ë¼ì¸ ìš”ì•½

```
10:00 - í”„ë¡œì íŠ¸ ì‹œì‘, PDF ìš”êµ¬ì‚¬í•­ ë¶„ì„
11:00 - Backend ì•„í‚¤í…ì²˜ ì„¤ê³„ ë° êµ¬í˜„
12:00 - API ì—”ë“œí¬ì¸íŠ¸ ê°œë°œ ë° í…ŒìŠ¤íŠ¸
13:00 - Frontend íƒ€ì… ì •ì˜ ë° ì„œë¹„ìŠ¤ ë ˆì´ì–´
14:00 - UI ì»´í¬ë„ŒíŠ¸ í†µí•© ë° ìŠ¤íƒ€ì¼ë§
15:00 - í…ŒìŠ¤íŠ¸ ì¤‘ ë¬¸ì œ ë°œê²¬ ë° í•´ê²°
16:00 - Tobler's Function ë§ˆì´ê·¸ë ˆì´ì…˜
17:00 - í•¨ìˆ˜ ì¸í„°í˜ì´ìŠ¤ ë‹¨ìˆœí™”
18:00 - ê³„ì‚° ì •í™•ë„ ê°œì„  (ê°€ì¤‘ í‰ê· )
19:00 - ê·¹ë‹¨ê°’ ê²€ì¦ ì‹œìŠ¤í…œ êµ¬ì¶•
20:00 - ë¬¸ì„œí™” ë° ìµœì¢… ë³´ê³ ì„œ ì‘ì„±
```

---

## ğŸ¯ ìµœì¢… í‰ê°€

### ëª©í‘œ ë‹¬ì„±ë„: â­â­â­â­â­ (5/5)

| ëª©í‘œ | ë‹¬ì„±ë„ | ë¹„ê³  |
|------|--------|------|
| ê²½ì‚¬ë„ ë¶„ì„ ê¸°ëŠ¥ êµ¬í˜„ | 100% | âœ… ì™„ë£Œ |
| ë³´í–‰ ì‹œê°„ ë³´ì • | 100% | âœ… Tobler's Function |
| UI í†µí•© | 100% | âœ… RouteDetailComponent |
| ë°ì´í„° ê²€ì¦ | 100% | âœ… ê·¹ë‹¨ê°’ ê²€ì¦ |
| ë¬¸ì„œí™” | 100% | âœ… 1,500+ ì¤„ |

### ì½”ë“œ í’ˆì§ˆ: A+
- âœ… íƒ€ì… ì•ˆì •ì„±
- âœ… ëª¨ë“ˆí™”
- âœ… ì—ëŸ¬ ì²˜ë¦¬
- âœ… ë¬¸ì„œí™”
- âœ… í…ŒìŠ¤íŠ¸ ê°€ëŠ¥ì„±

### ì‚¬ìš©ì ë§Œì¡±ë„: ì˜ˆìƒ ë†’ìŒ
- âœ… ì§ê´€ì  UI
- âœ… ì •í™•í•œ ì •ë³´
- âœ… íˆ¬ëª…í•œ ë°ì´í„° í’ˆì§ˆ
- âœ… ë¹ ë¥¸ ì‘ë‹µ ì‹œê°„

---

## ğŸ™ ê°ì‚¬ì˜ ë§

ì´ í”„ë¡œì íŠ¸ëŠ” ì‚¬ìš©ìì˜ ì˜ˆë¦¬í•œ í”¼ë“œë°±ê³¼ ì§ˆë¬¸ ë•ë¶„ì— ì§€ì†ì ìœ¼ë¡œ ê°œì„ ë  ìˆ˜ ìˆì—ˆìŠµë‹ˆë‹¤. íŠ¹íˆ "ì„¸ê·¸ë¨¼íŠ¸ë³„ ê³„ì‚°ì´ í•„ìš”í•˜ë‹¤"ëŠ” ì§€ì ì€ ë°ì´í„° ê²€ì¦ ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ê³„ê¸°ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.

> "ì™„ë²½í•œ ì½”ë“œëŠ” ì—†ë‹¤. í•˜ì§€ë§Œ ë” ë‚˜ì€ ì½”ë“œë¥¼ í–¥í•œ ì—¬ì •ì€ ê³„ì†ëœë‹¤."

---

**ë¬¸ì„œ ì‘ì„±**: 2025ë…„ 10ì›” 25ì¼  
**ë²„ì „**: 1.0.0  
**ìƒíƒœ**: âœ… ìµœì¢… ì™„ë£Œ

---

## ë¶€ë¡: ì£¼ìš” ì½”ë“œ ìŠ¤ë‹ˆí«

### A. Tobler's Hiking Function
```python
def calculate_slope_factor(slope_percent: float) -> float:
    """Tobler's Hiking Function (1993)"""
    if abs(slope_percent) > 60:
        warnings.warn(f"ê·¹ë‹¨ì ì¸ ê²½ì‚¬ë„ ê°ì§€: {slope_percent:.1f}%")
    
    S = slope_percent / 100
    velocity_kmh = 6 * math.exp(-3.5 * abs(S + 0.05))
    return velocity_kmh / 5.0
```

### B. ê±°ë¦¬ ê°€ì¤‘ í‰ê· 
```python
total_distance = sum(seg['distance'] for seg in segments)
weighted_sum = sum(seg['slope'] * seg['distance'] for seg in segments)
avg_slope = weighted_sum / total_distance
```

### C. ë°ì´í„° ê²€ì¦
```python
def validate_slope_data(segment_analysis):
    extreme_segments = [
        seg for seg in segment_analysis 
        if abs(seg['slope']) > 60
    ]
    return {
        'is_valid': len(extreme_segments) == 0,
        'warnings': [f"ê·¹ë‹¨ ê²½ì‚¬: {s['slope']:.1f}%" for s in extreme_segments],
        'stats': {...}
    }
```

### D. UI ë Œë”ë§
```tsx
{slopeAnalysis && !slopeAnalysis.error && (
  <View style={styles.slopeSection}>
    <View style={styles.slopeRow}>
      <View style={styles.slopeItem}>
        <Text style={styles.slopeLabel}>í‰ê·  ê²½ì‚¬</Text>
        <Text style={styles.slopeValue}>{avgSlope}%</Text>
      </View>
      {/* ... */}
    </View>
  </View>
)}
```

---

## 10. Phase 5: UI ê°œì„  ë° ì„¤ì • ì¡°ì • (2025-10-26)

### 10.1 Phase 5 ê°œìš”

**ì‘ì—… ê¸°ê°„**: 2025ë…„ 10ì›” 26ì¼  
**ì‘ì—… ëª©í‘œ**: Phase 4 êµ¬í˜„ í›„ ë°œê²¬ëœ UI ë²„ê·¸ ìˆ˜ì • ë° ì‚¬ìš©ì ê²½í—˜ ê°œì„ 

**ì£¼ìš” ì‘ì—…**:
1. Tobler Function ê·¹ë‹¨ê°’ ì œí•œ ì™„í™” (Â±40% â†’ Â±70%)
2. UI ë²„ê·¸ ìˆ˜ì • (`++` â†’ `+` í‘œì‹œ ë¬¸ì œ)
3. ê²½ê³  ì‹œìŠ¤í…œ ê°œì„  (40% ì´ìƒ ê²½ì‚¬ + ë‚´ë¦¬ë§‰ ì‹œê°„ ì¦ê°€)
4. ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ ê°œì„  (ìˆœì„œ ë²ˆí˜¸ + ì¤„ë°”ê¿ˆ)
5. ê²½ë¡œ ê°œìˆ˜ ì„¤ì • ì¡°ì • (1ê°œ â†’ 10ê°œ)

---

### 10.2 ê·¹ë‹¨ê°’ ì œí•œ ì™„í™”

#### ë¬¸ì œ ìƒí™©
- ê¸°ì¡´ Â±40% ì œí•œì´ ë„ˆë¬´ ë³´ìˆ˜ì 
- ì‹¤ì œë¡œ 60% ê²½ì‚¬(ì•½ 31Â°)ë„ ë„ë³´ ì´ë™ ê°€ëŠ¥
- ì„œìš¸ ì¼ë¶€ ì§€ì—­ì—ì„œ ìì£¼ ë‚˜íƒ€ë‚˜ëŠ” ê¸‰ê²½ì‚¬ê°€ ê³¼ë„í•˜ê²Œ ì œí•œë¨

#### í•´ê²° ë°©ë²•
```python
# backend/app/utils/elevation_helpers.py (line 349)
# ë³€ê²½ ì „
slope_percent = max(-40, min(40, slope_percent))

# ë³€ê²½ í›„
slope_percent = max(-70, min(70, slope_percent))
```

#### ë³€ê²½ ê·¼ê±°
- **Â±40% (ì•½ 22Â°)**: ë„ˆë¬´ ë³´ìˆ˜ì , ì‹¤ì œ ë„ë³´ ê²½ì‚¬ ë²”ìœ„ ì œí•œ
- **Â±70% (ì•½ 35Â°)**: ê¸‰ê²½ì‚¬ì´ì§€ë§Œ ë„ë³´ ê°€ëŠ¥í•œ ë²”ìœ„
- Tobler's Functionì€ ê·¹ë‹¨ ê²½ì‚¬ì—ì„œ ìë™ìœ¼ë¡œ ì†ë„ ê°ì†Œ ì ìš©

---

### 10.3 UI ë²„ê·¸ ìˆ˜ì •

#### ë¬¸ì œ ìƒí™©
```
í‰ê·  ê²½ì‚¬: -3.2%
ì˜ˆìƒ ì‹œê°„ ì¡°ì •: ++1ë¶„ 35ì´ˆ  âŒ (ë²„ê·¸)
```

#### ì›ì¸ ë¶„ì„
```tsx
// RouteDetailComponent.tsx (line 145)
// ë¬¸ì œ ì½”ë“œ
{adjustment > 0 ? '+' : ''}{Math.floor(Math.abs(adjustment) / 60)}ë¶„
```
- `adjustment > 0`ì´ë©´ `+` ì¶”ê°€
- í•˜ì§€ë§Œ ë¶„/ì´ˆ í‘œì‹œì—ì„œ ì´ë¯¸ `+` í¬í•¨
- ê²°ê³¼: `++1ë¶„ 35ì´ˆ`

#### í•´ê²° ë°©ë²•
```tsx
// ìˆ˜ì • í›„
{Math.floor(Math.abs(adjustment) / 60)}ë¶„
```
- ì¡°ê±´ë¶€ `+` ì œê±°
- ì‹œê°„ ê°’ë§Œ í‘œì‹œ (`1ë¶„ 35ì´ˆ`)

---

### 10.4 ê²½ê³  ì‹œìŠ¤í…œ ê°œì„ 

#### ê¸°ì¡´ ë¬¸ì œ
- í‰ê·  ê²½ì‚¬ -3.2%ì¸ë° ì‹œê°„ì´ ì¦ê°€(+1ë¶„ 35ì´ˆ)
- ì‚¬ìš©ìê°€ ì´ìœ ë¥¼ ì´í•´í•˜ê¸° ì–´ë ¤ì›€

#### ê°œì„ ëœ ê²½ê³  ì‹œìŠ¤í…œ

**1. ê·¹ë‹¨ ê²½ì‚¬ ê²½ê³  (40% ì´ìƒ)**
```tsx
{extremeSlopes.length > 0 && (
  <View style={styles.warningBox}>
    <Text style={styles.warningTitle}>âš ï¸ ê°€íŒŒë¥¸ êµ¬ê°„ ì£¼ì˜</Text>
    <Text style={styles.warningText}>
      ì´ ê²½ë¡œì—ëŠ” ê²½ì‚¬ê°€ 40% ì´ìƒì¸ ë§¤ìš° ê°€íŒŒë¥¸ êµ¬ê°„ì´ {extremeSlopes.length}ê°œ ìˆìŠµë‹ˆë‹¤.
      ê°€ëŠ¥í•˜ë‹¤ë©´ ì—˜ë¦¬ë² ì´í„°ë‚˜ ì—ìŠ¤ì»¬ë ˆì´í„°ë¥¼ ì´ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
    </Text>
  </View>
)}
```

**2. ë‚´ë¦¬ë§‰ ì‹œê°„ ì¦ê°€ ì„¤ëª…**
```tsx
{avgSlope < 0 && adjustment > 0 && (
  <View style={styles.infoBox}>
    <Text style={styles.infoTitle}>ğŸ’¡ ê²½ì‚¬ë„ì™€ ì†Œìš”ì‹œê°„</Text>
    <Text style={styles.infoText}>
      í‰ê·  ê²½ì‚¬ê°€ ë‚´ë¦¬ë§‰(-{Math.abs(avgSlope).toFixed(1)}%)ì´ì§€ë§Œ ì†Œìš”ì‹œê°„ì´ ì¦ê°€í–ˆìŠµë‹ˆë‹¤.
      ì´ëŠ” ê°€íŒŒë¥¸ ë‚´ë¦¬ë§‰ê¸¸ì—ì„œ ì•ˆì „ì„ ìœ„í•´ ê±¸ìŒì´ ëŠë ¤ì§€ëŠ” ê²ƒì„ ë°˜ì˜í•œ ê²ƒì…ë‹ˆë‹¤.
      (Tobler's Hiking Function)
    </Text>
  </View>
)}
```

#### ê²½ê³  ì‹œìŠ¤í…œ íŠ¹ì§•
- **ë™ì‹œ í‘œì‹œ**: ë‘ ê²½ê³ ê°€ ëª¨ë‘ í•´ë‹¹ë˜ë©´ ë™ì‹œì— í‘œì‹œ
- **ëª…í™•í•œ ì„¤ëª…**: ì‚¬ìš©ìê°€ ì´í•´í•˜ê¸° ì‰¬ìš´ ì„¤ëª… ì œê³µ
- **ì‹œê°ì  êµ¬ë¶„**: `âš ï¸` (ê²½ê³ ), `ğŸ’¡` (ì •ë³´) ì•„ì´ì½˜ ì‚¬ìš©

---

### 10.5 ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ ê°œì„ 

#### ê¸°ì¡´ ë¬¸ì œ
- ê¸´ í…ìŠ¤íŠ¸ê°€ í•œ ì¤„ë¡œ í‘œì‹œë˜ì–´ ì˜ë¦¼
- ì—¬ëŸ¬ êµ¬ê°„ì´ ì‰¼í‘œë¡œë§Œ êµ¬ë¶„ë˜ì–´ ê°€ë…ì„± ë‚®ìŒ

#### ê°œì„ ëœ í‘œì‹œ ë°©ì‹
```tsx
{slopeAnalysis.segment_preview && (
  <View style={styles.slopePreview}>
    <Text style={styles.slopePreviewTitle}>ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸°</Text>
    <View style={styles.slopePreviewTextContainer}>
      <Text style={styles.slopePreviewText}>
        {slopeAnalysis.segment_preview
          .split(', ')
          .map((segment, index) => `${index + 1}ë²ˆì§¸ ë³´í–‰ êµ¬ê°„:\n${segment}`)
          .join('\n\n')}
      </Text>
    </View>
  </View>
)}
```

#### ê°œì„  ì‚¬í•­
1. **ìˆœì„œ ë²ˆí˜¸ ì¶”ê°€**: "1ë²ˆì§¸ ë³´í–‰ êµ¬ê°„", "2ë²ˆì§¸ ë³´í–‰ êµ¬ê°„"
2. **ì¤„ë°”ê¿ˆ ì¶”ê°€**: ê° êµ¬ê°„ì„ ë³„ë„ ì¤„ë¡œ í‘œì‹œ
3. **ë ˆì´ì•„ì›ƒ ì¡°ì •**: `flexDirection: 'column'`ìœ¼ë¡œ ì„¸ë¡œ ì •ë ¬

#### í‘œì‹œ ì˜ˆì‹œ
```
ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸°
1ë²ˆì§¸ ë³´í–‰ êµ¬ê°„:
ì™„ë§Œ -4.8%

2ë²ˆì§¸ ë³´í–‰ êµ¬ê°„:
ê°€íŒŒë¦„ â†“ -18.2%

3ë²ˆì§¸ ë³´í–‰ êµ¬ê°„:
ì™„ë§Œ 1.2%
```

---

### 10.6 ê²½ë¡œ ê°œìˆ˜ ì„¤ì • ì¡°ì •

#### ê¸°ì¡´ ì„¤ì •
```typescript
// api.ts (line 62)
count: params.count?.toString() || '1',  // ê¸°ë³¸ê°’: 1ê°œ

// ApiTestComponent.tsx (line 56)
count: 1,
```

#### ë³€ê²½ëœ ì„¤ì •
```typescript
// api.ts (line 62)
count: params.count?.toString() || '10',  // ê¸°ë³¸ê°’: 10ê°œ

// ApiTestComponent.tsx (line 56)
count: 10,
```

#### ë³€ê²½ ì´ìœ 
- **ì‚¬ìš©ì ì„ íƒê¶Œ**: ì—¬ëŸ¬ ê²½ë¡œ ì˜µì…˜ ì œê³µ
- **ê²½ì‚¬ ë¹„êµ**: ë‹¤ì–‘í•œ ê²½ë¡œì˜ ê²½ì‚¬ë„ ë¹„êµ ê°€ëŠ¥
- **API íš¨ìœ¨ì„±**: Tmap APIëŠ” ìµœëŒ€ 10ê°œ ê²½ë¡œ ì§€ì›

---

### 10.7 TypeScript ì—ëŸ¬ ìˆ˜ì •

#### ë¬¸ì œ
```typescript
// ApiTestComponent.tsx
const itinerary = routeData.metaData.plan.itineraries[0];
// TypeError: Cannot read property '0' of undefined
```

#### í•´ê²°
```typescript
const itinerary = routeData.metaData.plan.itineraries;
if (itinerary) {
  // itineraryê°€ ì¡´ì¬í•  ë•Œë§Œ ì²˜ë¦¬
}
```

---

### 10.8 Phase 5 ìµœì¢… ë³€ê²½ íŒŒì¼

| íŒŒì¼ | ë³€ê²½ ë¼ì¸ | ë³€ê²½ ë‚´ìš© |
|------|----------|----------|
| `backend/app/utils/elevation_helpers.py` | 349 | ê·¹ë‹¨ê°’ ì œí•œ Â±40% â†’ Â±70% |
| `frontend/components/RouteDetailComponent.tsx` | 145 | `++` ë²„ê·¸ ìˆ˜ì • |
| `frontend/components/RouteDetailComponent.tsx` | 171-206 | ê²½ê³  ì‹œìŠ¤í…œ ì¶”ê°€ |
| `frontend/components/RouteDetailComponent.tsx` | 237-244 | ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸° ê°œì„  |
| `frontend/components/RouteDetailComponent.tsx` | 589-592 | ìŠ¤íƒ€ì¼ ì¶”ê°€ (column ë ˆì´ì•„ì›ƒ) |
| `frontend/services/api.ts` | 62 | ê¸°ë³¸ ê²½ë¡œ ê°œìˆ˜ 1 â†’ 10 |
| `frontend/components/ApiTestComponent.tsx` | 24-25 | TypeScript null ì²´í¬ |
| `frontend/components/ApiTestComponent.tsx` | 56 | ê²½ë¡œ ê°œìˆ˜ ì„¤ì • |

---

### 10.9 Phase 5 ì£¼ìš” ì„±ê³¼

#### 1. ì‚¬ìš©ì ê²½í—˜ ê°œì„ 
- âœ… ì§ê´€ì ì¸ ê²½ê³  ì‹œìŠ¤í…œ
- âœ… ëª…í™•í•œ ì‹œê°„ ì¡°ì • í‘œì‹œ
- âœ… ê°€ë…ì„± ë†’ì€ ê²½ì‚¬ ë¯¸ë¦¬ë³´ê¸°

#### 2. ê¸°ìˆ ì  ê°œì„ 
- âœ… ê·¹ë‹¨ê°’ ì œí•œ ì™„í™”ë¡œ ì •í™•ë„ í–¥ìƒ
- âœ… TypeScript íƒ€ì… ì•ˆì •ì„± ê°œì„ 
- âœ… UI ë²„ê·¸ ìˆ˜ì •

#### 3. ì„¤ì • ìµœì í™”
- âœ… ê²½ë¡œ ê°œìˆ˜ ê¸°ë³¸ê°’ 10ê°œë¡œ ì¦ê°€
- âœ… ì‚¬ìš©ì ì„ íƒê¶Œ í™•ëŒ€

---

### 10.10 Phase 5 í…ŒìŠ¤íŠ¸ ê²°ê³¼

#### í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤
1. **ê¸‰ê²½ì‚¬ êµ¬ê°„ í¬í•¨ ê²½ë¡œ**
   - í‰ê·  ê²½ì‚¬: -3.2%
   - ìµœëŒ€ ê²½ì‚¬: -60.8%
   - ì‹œê°„ ì¡°ì •: +1ë¶„ 35ì´ˆ
   - âœ… ê²½ê³  ì‹œìŠ¤í…œ ì •ìƒ ì‘ë™
   - âœ… ì„¤ëª… ë©”ì‹œì§€ í‘œì‹œ

2. **ì—¬ëŸ¬ ê²½ë¡œ ìš”ì²­**
   - ìš”ì²­: 10ê°œ ê²½ë¡œ
   - ì‘ë‹µ: 10ê°œ ê²½ë¡œ (ê²½ì‚¬ë„ ë‹¤ì–‘)
   - âœ… ëª¨ë“  ê²½ë¡œì— ê²½ì‚¬ ë¶„ì„ ì ìš©

3. **í‘œì‹œ ê°œì„ **
   - âœ… `++` ë²„ê·¸ ìˆ˜ì • í™•ì¸
   - âœ… ìˆœì„œ ë²ˆí˜¸ + ì¤„ë°”ê¿ˆ ì ìš©
   - âœ… ë ˆì´ì•„ì›ƒ ì •ìƒ í‘œì‹œ

---

**Phase 5 ì™„ë£Œì¼**: 2025ë…„ 10ì›” 26ì¼  
**ë‹¤ìŒ ë‹¨ê³„**: Phase 6 - ì¶”ê°€ ê¸°ëŠ¥ ê°œë°œ (ì˜ˆì •)

---

**END OF REPORT**
